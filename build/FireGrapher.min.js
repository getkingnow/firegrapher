var FireGrapher=function(){"use strict";return FireGrapher=function(){},FireGrapher.prototype.graph=function(e,o,n){this.firebaseRef=o,console.log(e),console.log(o),console.log(n);var i=["grid","line","scatter"];if(-1===i.indexOf(n.type))throw new Error('Invalid chart type. Must be "grid", "line", or "scatter"');this.drawGraph(e);var t=n.path.split("/");console.log(t),this.parsePathNode(["/"],t,0).then(function(e){e.forEach(function(e){console.log(e),o.child(e).on("child_added",function(o){var i=o.val(),t=e.split("/");console.log(t);var r=t[t.length-2];console.log(r),this.addToD3({line:r,xCoord:i[n.xCoord.value],yCoord:i[n.yCoord.value]})}.bind(this))}.bind(this))}.bind(this))},FireGrapher.prototype.parsePathNode=function(e,o,n){return new RSVP.Promise(function(i){console.log("Calling parsePathNode() with index "+n);var t=o[n];if("*"===t[0])console.assert(n===o.length-1,"WHATTTT?"),console.log(n+": individual record"),i(e);else if("$"===t[0]){console.log(n+": param");var r=[];e.forEach(function(e){r.push(new RSVP.Promise(function(o){console.log(e),this.firebaseRef.child(e).once("value",function(n){console.log(n);var i=[];n.forEach(function(o){console.log(o.name()),i.push(e+o.name()+"/")}.bind(this)),o(i)}.bind(this))}.bind(this)))}.bind(this)),new RSVP.all(r).then(function(e){var t=[];e.forEach(function(e){e.forEach(function(e){t.push(e)})}),console.log(t),this.parsePathNode(t,o,n+1).then(function(e){console.log("Final paths: "+n),console.log(e),i(e)})}.bind(this))}else{console.log(n+": regular node");var a=[];e.forEach(function(e){a.push(e+=t+"/")}),this.parsePathNode(a,o,n+1).then(function(e){console.log("Final paths: "+n),console.log(e),i(e)})}}.bind(this))},FireGrapher.prototype.addToLineGraph=function(e){"undefined"==typeof this.graphData[e.line]&&(this.graphData[e.line]=[]),this.graphData[e.line][e.xCoord]=e.yCoord;var o=this.graphLines[e.line];"undefined"==typeof o?(o=d3.svg.line().x(function(e,o){return this.interpolateXCoord(o)}.bind(this)).y(function(e){return this.interpolateYCoord(e)}.bind(this)).interpolate("basis"),this.graph.append("svg:path").attr("d",o(this.graphData[e.line])).attr("id",e.line),this.graphLines[e.line]=o):this.graph.select("#"+e.line).data([this.graphData[e.line]]).attr("d",o)},FireGrapher.prototype.drawGraph=function(e){this.drawLineGraph(e)},FireGrapher.prototype.drawLineGraph=function(e){var o=800,n=120,i=0,t=30,r=40,a=150;this.graphData={},this.graphLines={},this.interpolateXCoord=d3.scale.linear().domain([i,t]).range([0,o]),this.interpolateYCoord=d3.scale.linear().domain([r,a]).range([0,n]),this.graph=d3.select(e).append("svg:svg").attr("width","100%").attr("height","100%")},FireGrapher}();"undefined"!=typeof module&&(module.exports=FireGrapher);